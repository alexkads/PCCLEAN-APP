import { ScrollView } from "std-widgets.slint";

// Imports de tipos
import { CategoryData } from "types.slint";

// Imports de componentes
import { StatusBar } from "components/StatusBar.slint";
import { Header } from "components/Header.slint";
import { StatsCard } from "components/StatsCard.slint";
import { ActionButtons } from "components/ActionButtons.slint";
import { CategoriesList } from "components/CategoriesList.slint";
import { ConfirmDialog } from "components/ConfirmDialog.slint";

// Main Window com Material Design
export component AppWindow inherits Window {
    title: "PCCLEAN - Ultra Modern Disk Cleaner";
    preferred-width: 1280px;
    preferred-height: 900px;
    min-width: 900px;
    min-height: 650px;
    
    // Properties públicas
    in-out property <bool> is-scanning: false;
    in-out property <bool> is-cleaning: false;
    in-out property <bool> has-results: false;
    in-out property <string> total-size-display: "0.00 GB";
    in-out property <int> total-items: 0;
    in-out property <[CategoryData]> categories: [];
    
    // Propriedade privada
    private property <bool> show-confirm-dialog: false;
    
    // Callbacks
    callback start-scan <=> action-buttons.start-scan;
    callback confirm-clean;
    callback cancel-clean;
    callback category-selection-changed(int, bool);
    
    // Acessibilidade
    accessible-role: none;
    accessible-label: "PCCLEAN Disk Cleaner Application";
    
    // Layout principal
    VerticalLayout {
        // Status bar no topo
        StatusBar {
            status: is-scanning ? "SCANNING" : is-cleaning ? "CLEANING" : "READY";
            is-busy: is-scanning || is-cleaning;
            total-size: total-size-display;
            total-items: total-items;
        }
        
        // Conteúdo principal com scroll
        ScrollView {
            VerticalLayout {
                padding: 24px;
                spacing: 24px;
                
                // Header
                Header { }
                
                // Stats Card
                StatsCard {
                    has-results: has-results;
                    is-scanning: is-scanning;
                    total-size-display: total-size-display;
                    total-items: total-items;
                }
                
                // Action Buttons
                action-buttons := ActionButtons {
                    is-scanning: is-scanning;
                    is-cleaning: is-cleaning;
                    has-results: has-results;
                    categories-count: categories.length;
                    
                    clean-clicked => {
                        show-confirm-dialog = true;
                    }
                }
                
                // Categories List
                if has-results && !is-scanning: CategoriesList {
                    categories: categories;
                    category-selection-changed(index, checked) => {
                        root.category-selection-changed(index, checked);
                    }
                }
            }
        }
    }
    
    // Confirm Dialog Overlay
    ConfirmDialog {
        show: show-confirm-dialog;
        confirmed => {
            show-confirm-dialog = false;
            confirm-clean();
        }
        cancelled => {
            show-confirm-dialog = false;
            cancel-clean();
        }
    }
}
